%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{times}
\expandafter\ifx\csname T@LGR\endcsname\relax
\else
% LGR was declared as font encoding
  \substitutefont{LGR}{\rmdefault}{cmr}
  \substitutefont{LGR}{\sfdefault}{cmss}
  \substitutefont{LGR}{\ttdefault}{cmtt}
\fi
\expandafter\ifx\csname T@X2\endcsname\relax
  \expandafter\ifx\csname T@T2A\endcsname\relax
  \else
  % T2A was declared as font encoding
    \substitutefont{T2A}{\rmdefault}{cmr}
    \substitutefont{T2A}{\sfdefault}{cmss}
    \substitutefont{T2A}{\ttdefault}{cmtt}
  \fi
\else
% X2 was declared as font encoding
  \substitutefont{X2}{\rmdefault}{cmr}
  \substitutefont{X2}{\sfdefault}{cmss}
  \substitutefont{X2}{\ttdefault}{cmtt}
\fi


\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{ipfp\_python}
\date{Nov 15, 2020}
\release{1.0.0}
\author{Bernard Salanie}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}



\chapter{Module \sphinxstyleliteralintitle{\sphinxupquote{ipfp\_solvers}}}
\label{\detokenize{ipfp_solvers:module-ipfp_solvers}}\label{\detokenize{ipfp_solvers:module-ipfp-solvers}}\label{\detokenize{ipfp_solvers::doc}}\index{module@\spxentry{module}!ipfp\_solvers@\spxentry{ipfp\_solvers}}\index{ipfp\_solvers@\spxentry{ipfp\_solvers}!module@\spxentry{module}}
Implementations of the IPFP algorithm to solve for equilibrium and do comparative statics
in several variants of the \sphinxhref{https://www.jstor.org/stable/10.1086/498585?seq=1}{Choo and Siow 2006} model:
\begin{itemize}
\item {} 
homoskedastic with singles (as in CS 2006)

\item {} 
homoskedastic without singles

\item {} 
gender\sphinxhyphen{}heteroskedastic: with a scale parameter on the error term for women

\item {} 
gender\sphinxhyphen{} and type\sphinxhyphen{}heteroskedastic: with a scale parameter on the error term for women

\end{itemize}

each solver, when fed the joint surplus and margins,
returns the equilibrium matching patterns, the adding\sphinxhyphen{}up errors on the margins,
and if requested (gr=True) the derivatives of the matching patterns in all primitives.
\index{ipfp\_hetero\_solver() (in module ipfp\_solvers)@\spxentry{ipfp\_hetero\_solver()}\spxextra{in module ipfp\_solvers}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ipfp_solvers:ipfp_solvers.ipfp_hetero_solver}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{ipfp\_solvers.}}\sphinxbfcode{\sphinxupquote{ipfp\_hetero\_solver}}}{\emph{\DUrole{n}{Phi}}, \emph{\DUrole{n}{men\_margins}}, \emph{\DUrole{n}{women\_margins}}, \emph{\DUrole{n}{tau}}, \emph{\DUrole{n}{tol}\DUrole{o}{=}\DUrole{default_value}{1e\sphinxhyphen{}09}}, \emph{\DUrole{n}{gr}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{verbose}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{maxiter}\DUrole{o}{=}\DUrole{default_value}{1000}}}{}
solve for equilibrium in a  in a gender\sphinxhyphen{}heteroskedastic Choo and Siow market

given systematic surplus and margins and a scale parameter dist\_params{[}0{]}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Phi}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} matrix of systematic surplus, shape (ncat\_men, ncat\_women)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{men\_margins}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} vector of men margins, shape (ncat\_men)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{women\_margins}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} vector of women margins, shape (ncat\_women)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{tau}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} a positive scale parameter for the error term on women

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{tol}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} tolerance on change in solution

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{gr}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} if True, also evaluate derivatives of muxy wrt Phi

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{verbose}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} prints stuff

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{maxiter}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} maximum number of iterations

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{dist\_params}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} array of one positive number (the scale parameter for women)

\end{itemize}

\item[{Returns}] \leavevmode
(muxy, mux0, mu0y), errors on margins marg\_err\_x, marg\_err\_y,
and gradients of (muxy, mux0, mu0y)
wrt (men\_margins, women\_margins, Phi, dist\_params{[}0{]}) if gr=True

\end{description}\end{quote}

\end{fulllineitems}

\index{ipfp\_heteroxy\_solver() (in module ipfp\_solvers)@\spxentry{ipfp\_heteroxy\_solver()}\spxextra{in module ipfp\_solvers}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ipfp_solvers:ipfp_solvers.ipfp_heteroxy_solver}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{ipfp\_solvers.}}\sphinxbfcode{\sphinxupquote{ipfp\_heteroxy\_solver}}}{\emph{\DUrole{n}{Phi}}, \emph{\DUrole{n}{men\_margins}}, \emph{\DUrole{n}{women\_margins}}, \emph{\DUrole{n}{sigma\_x}}, \emph{\DUrole{n}{tau\_y}}, \emph{\DUrole{n}{tol}\DUrole{o}{=}\DUrole{default_value}{1e\sphinxhyphen{}09}}, \emph{\DUrole{n}{gr}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{maxiter}\DUrole{o}{=}\DUrole{default_value}{1000}}, \emph{\DUrole{n}{verbose}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
solve for equilibrium in a  in a gender\sphinxhyphen{} and type\sphinxhyphen{}heteroskedastic Choo and Siow market

given systematic surplus and margins and a scale parameter dist\_params{[}0{]}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Phi}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} matrix of systematic surplus, shape (ncat\_men, ncat\_women)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{men\_margins}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} vector of men margins, shape (ncat\_men)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{women\_margins}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} vector of women margins, shape (ncat\_women)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{sigma\_x}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} an array of positive numbers of shape (ncat\_men)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{tau\_y}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} an array of positive numbers of shape (ncat\_women)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{tol}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} tolerance on change in solution

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{gr}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} if True, also evaluate derivatives of muxy wrt Phi

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{verbose}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} prints stuff

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{maxiter}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} maximum number of iterations

\end{itemize}

\item[{Returns}] \leavevmode
(muxy, mux0, mu0y), errors on margins marg\_err\_x, marg\_err\_y,
and gradients of (muxy, mux0, mu0y)
wrt (men\_margins, women\_margins, Phi, dist\_params) if gr=True

\end{description}\end{quote}

\end{fulllineitems}

\index{ipfp\_homo\_nosingles\_solver() (in module ipfp\_solvers)@\spxentry{ipfp\_homo\_nosingles\_solver()}\spxextra{in module ipfp\_solvers}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ipfp_solvers:ipfp_solvers.ipfp_homo_nosingles_solver}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{ipfp\_solvers.}}\sphinxbfcode{\sphinxupquote{ipfp\_homo\_nosingles\_solver}}}{\emph{\DUrole{n}{Phi}}, \emph{\DUrole{n}{men\_margins}}, \emph{\DUrole{n}{women\_margins}}, \emph{\DUrole{n}{tol}\DUrole{o}{=}\DUrole{default_value}{1e\sphinxhyphen{}09}}, \emph{\DUrole{n}{gr}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{verbose}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{maxiter}\DUrole{o}{=}\DUrole{default_value}{1000}}}{}
solve for equilibrium in a Choo and Siow market without singles

given systematic surplus and margins
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Phi}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} matrix of systematic surplus, shape (ncat\_men, ncat\_women)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{men\_margins}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} vector of men margins, shape (ncat\_men)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{women\_margins}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} vector of women margins, shape (ncat\_women)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{tol}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} tolerance on change in solution

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{gr}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} if True, also evaluate derivatives of muxy wrt Phi

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{verbose}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} prints stuff

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{maxiter}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} maximum number of iterations

\end{itemize}

\item[{Returns}] \leavevmode
muxy, marg\_err\_x, marg\_err\_y
and gradients of muxy wrt Phi if gr=True

\end{description}\end{quote}

\end{fulllineitems}

\index{ipfp\_homo\_solver() (in module ipfp\_solvers)@\spxentry{ipfp\_homo\_solver()}\spxextra{in module ipfp\_solvers}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ipfp_solvers:ipfp_solvers.ipfp_homo_solver}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{ipfp\_solvers.}}\sphinxbfcode{\sphinxupquote{ipfp\_homo\_solver}}}{\emph{\DUrole{n}{Phi}}, \emph{\DUrole{n}{men\_margins}}, \emph{\DUrole{n}{women\_margins}}, \emph{\DUrole{n}{tol}\DUrole{o}{=}\DUrole{default_value}{1e\sphinxhyphen{}09}}, \emph{\DUrole{n}{gr}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{verbose}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{maxiter}\DUrole{o}{=}\DUrole{default_value}{1000}}}{}
solve for equilibrium in a Choo and Siow market

given systematic surplus and margins
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{Phi}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} matrix of systematic surplus, shape (ncat\_men, ncat\_women)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{men\_margins}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} vector of men margins, shape (ncat\_men)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{women\_margins}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} vector of women margins, shape (ncat\_women)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{tol}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} tolerance on change in solution

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{gr}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} if True, also evaluate derivatives of muxy wrt Phi

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{verbose}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} prints stuff

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{maxiter}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} maximum number of iterations

\end{itemize}

\item[{Returns}] \leavevmode
(muxy, mux0, mu0y), errors on margins marg\_err\_x, marg\_err\_y,
and gradients of (muxy, mux0, mu0y)
wrt (men\_margins, women\_margins, Phi) if gr=True

\end{description}\end{quote}

\end{fulllineitems}



\chapter{Module \sphinxstyleliteralintitle{\sphinxupquote{ipfp\_utils}}}
\label{\detokenize{ipfp_utils:module-ipfp_utils}}\label{\detokenize{ipfp_utils:module-ipfp-utils}}\label{\detokenize{ipfp_utils::doc}}\index{module@\spxentry{module}!ipfp\_utils@\spxentry{ipfp\_utils}}\index{ipfp\_utils@\spxentry{ipfp\_utils}!module@\spxentry{module}}
some utility programs used by ipfp\_solvers
\index{der\_npexp() (in module ipfp\_utils)@\spxentry{der\_npexp()}\spxextra{in module ipfp\_utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ipfp_utils:ipfp_utils.der_npexp}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{ipfp\_utils.}}\sphinxbfcode{\sphinxupquote{der\_npexp}}}{\emph{\DUrole{n}{arr}\DUrole{p}{:} \DUrole{n}{numpy.array}}, \emph{\DUrole{n}{bigx}\DUrole{p}{:} \DUrole{n}{float} \DUrole{o}{=} \DUrole{default_value}{30.0}}, \emph{\DUrole{n}{verbose}\DUrole{p}{:} \DUrole{n}{bool} \DUrole{o}{=} \DUrole{default_value}{False}}}{{ $\rightarrow$ numpy.array}}
derivative of \(C^2\) extension of  \(\exp(a)\) above \sphinxtitleref{bigx}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{arr}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} a Numpy array

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{bigx}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} upper bound

\end{itemize}

\item[{Returns}] \leavevmode
derivative of  \(\exp(a)\)  \(C^2\)\sphinxhyphen{}extended above \sphinxtitleref{bigx}

\end{description}\end{quote}

\end{fulllineitems}

\index{der\_nplog() (in module ipfp\_utils)@\spxentry{der\_nplog()}\spxextra{in module ipfp\_utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ipfp_utils:ipfp_utils.der_nplog}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{ipfp\_utils.}}\sphinxbfcode{\sphinxupquote{der\_nplog}}}{\emph{\DUrole{n}{arr}\DUrole{p}{:} \DUrole{n}{numpy.array}}, \emph{\DUrole{n}{eps}\DUrole{p}{:} \DUrole{n}{float} \DUrole{o}{=} \DUrole{default_value}{1e\sphinxhyphen{}30}}, \emph{\DUrole{n}{verbose}\DUrole{p}{:} \DUrole{n}{bool} \DUrole{o}{=} \DUrole{default_value}{False}}}{{ $\rightarrow$ numpy.array}}
derivative of \(C^2\) extension of  \(\ln(a)\) below \sphinxtitleref{eps}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{arr}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} a Numpy array

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{eps}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} lower bound

\end{itemize}

\item[{Returns}] \leavevmode
derivative of  \(\ln(a)\) \(C^2\)\sphinxhyphen{}extended below \sphinxtitleref{eps}

\end{description}\end{quote}

\end{fulllineitems}

\index{der\_nppow() (in module ipfp\_utils)@\spxentry{der\_nppow()}\spxextra{in module ipfp\_utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ipfp_utils:ipfp_utils.der_nppow}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{ipfp\_utils.}}\sphinxbfcode{\sphinxupquote{der\_nppow}}}{\emph{\DUrole{n}{a}\DUrole{p}{:} \DUrole{n}{numpy.array}}, \emph{\DUrole{n}{b}\DUrole{p}{:} \DUrole{n}{Union\DUrole{p}{{[}}int\DUrole{p}{, }float\DUrole{p}{, }numpy.array\DUrole{p}{{]}}}}}{{ $\rightarrow$ numpy.array}}
evaluates the derivatives in a and b of element\sphinxhyphen{}by\sphinxhyphen{}element a**b
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{a}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} 

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{float}}\sphinxstyleliteralstrong{\sphinxupquote{, }}\sphinxstyleliteralstrong{\sphinxupquote{np.array}}\sphinxstyleliteralstrong{\sphinxupquote{{]} }}\sphinxstyleliteralstrong{\sphinxupquote{b}} (\sphinxstyleliteralemphasis{\sphinxupquote{Union}}\sphinxstyleliteralemphasis{\sphinxupquote{{[}}}\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}) \textendash{} if an array,
should have the same shape as \sphinxtitleref{a}

\end{itemize}

\item[{Returns}] \leavevmode
a pair of two arrays of the same shape as \sphinxtitleref{a}

\end{description}\end{quote}

\end{fulllineitems}

\index{describe\_array() (in module ipfp\_utils)@\spxentry{describe\_array()}\spxextra{in module ipfp\_utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ipfp_utils:ipfp_utils.describe_array}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{ipfp\_utils.}}\sphinxbfcode{\sphinxupquote{describe\_array}}}{\emph{\DUrole{n}{v}\DUrole{p}{:} \DUrole{n}{numpy.array}}, \emph{\DUrole{n}{name}\DUrole{p}{:} \DUrole{n}{str} \DUrole{o}{=} \DUrole{default_value}{\textquotesingle{}v\textquotesingle{}}}}{}
descriptive statistics on an array interpreted as a vector
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{v}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} the array

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{name}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} its name

\end{itemize}

\item[{Returns}] \leavevmode
the \sphinxtitleref{scipy.stats.describe} object

\end{description}\end{quote}

\end{fulllineitems}

\index{npexp() (in module ipfp\_utils)@\spxentry{npexp()}\spxextra{in module ipfp\_utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ipfp_utils:ipfp_utils.npexp}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{ipfp\_utils.}}\sphinxbfcode{\sphinxupquote{npexp}}}{\emph{\DUrole{n}{arr}\DUrole{p}{:} \DUrole{n}{numpy.array}}, \emph{\DUrole{n}{bigx}\DUrole{p}{:} \DUrole{n}{float} \DUrole{o}{=} \DUrole{default_value}{30.0}}, \emph{\DUrole{n}{verbose}\DUrole{p}{:} \DUrole{n}{bool} \DUrole{o}{=} \DUrole{default_value}{False}}}{{ $\rightarrow$ numpy.array}}
\(C^2\) extension of  \(\exp(a)\) above \sphinxtitleref{bigx}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{arr}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} a Numpy array

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{bigx}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} upper bound

\end{itemize}

\item[{Returns}] \leavevmode
:math:exp(a)\textasciigrave{}  \(C^2\)\sphinxhyphen{}extended above \sphinxtitleref{bigx}

\end{description}\end{quote}

\end{fulllineitems}

\index{nplog() (in module ipfp\_utils)@\spxentry{nplog()}\spxextra{in module ipfp\_utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ipfp_utils:ipfp_utils.nplog}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{ipfp\_utils.}}\sphinxbfcode{\sphinxupquote{nplog}}}{\emph{\DUrole{n}{arr}\DUrole{p}{:} \DUrole{n}{numpy.array}}, \emph{\DUrole{n}{eps}\DUrole{p}{:} \DUrole{n}{float} \DUrole{o}{=} \DUrole{default_value}{1e\sphinxhyphen{}30}}, \emph{\DUrole{n}{verbose}\DUrole{p}{:} \DUrole{n}{bool} \DUrole{o}{=} \DUrole{default_value}{False}}}{{ $\rightarrow$ numpy.array}}
\(C^2\) extension of  \(\ln(a)\) below \sphinxtitleref{eps}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{arr}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} a Numpy array

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{eps}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} lower bound

\end{itemize}

\item[{Returns}] \leavevmode
\(\ln(a)\) \(C^2\)\sphinxhyphen{}extended below \sphinxtitleref{eps}

\end{description}\end{quote}

\end{fulllineitems}

\index{npmaxabs() (in module ipfp\_utils)@\spxentry{npmaxabs()}\spxextra{in module ipfp\_utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ipfp_utils:ipfp_utils.npmaxabs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{ipfp\_utils.}}\sphinxbfcode{\sphinxupquote{npmaxabs}}}{\emph{\DUrole{n}{arr}\DUrole{p}{:} \DUrole{n}{numpy.array}}}{{ $\rightarrow$ float}}
maximum absolute value in an array
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{arr}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} Numpy array

\item[{Returns}] \leavevmode
a float

\end{description}\end{quote}

\end{fulllineitems}

\index{nppow() (in module ipfp\_utils)@\spxentry{nppow()}\spxextra{in module ipfp\_utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ipfp_utils:ipfp_utils.nppow}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{ipfp\_utils.}}\sphinxbfcode{\sphinxupquote{nppow}}}{\emph{\DUrole{n}{a}\DUrole{p}{:} \DUrole{n}{numpy.array}}, \emph{\DUrole{n}{b}\DUrole{p}{:} \DUrole{n}{Union\DUrole{p}{{[}}int\DUrole{p}{, }float\DUrole{p}{, }numpy.array\DUrole{p}{{]}}}}}{{ $\rightarrow$ numpy.array}}
evaluates a**b element\sphinxhyphen{}by\sphinxhyphen{}element
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{a}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} 

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{float}}\sphinxstyleliteralstrong{\sphinxupquote{, }}\sphinxstyleliteralstrong{\sphinxupquote{np.array}}\sphinxstyleliteralstrong{\sphinxupquote{{]} }}\sphinxstyleliteralstrong{\sphinxupquote{b}} (\sphinxstyleliteralemphasis{\sphinxupquote{Union}}\sphinxstyleliteralemphasis{\sphinxupquote{{[}}}\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}) \textendash{} if an array,
should have the same shape as \sphinxtitleref{a}

\end{itemize}

\item[{Returns}] \leavevmode
an array of the same shape as \sphinxtitleref{a}

\end{description}\end{quote}

\end{fulllineitems}

\index{nprepeat\_col() (in module ipfp\_utils)@\spxentry{nprepeat\_col()}\spxextra{in module ipfp\_utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ipfp_utils:ipfp_utils.nprepeat_col}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{ipfp\_utils.}}\sphinxbfcode{\sphinxupquote{nprepeat\_col}}}{\emph{\DUrole{n}{v}\DUrole{p}{:} \DUrole{n}{numpy.array}}, \emph{\DUrole{n}{n}\DUrole{p}{:} \DUrole{n}{int}}}{{ $\rightarrow$ numpy.array}}
create a matrix with \sphinxtitleref{n} columns equal to \sphinxtitleref{v}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{v}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} a 1\sphinxhyphen{}dim array of size \sphinxtitleref{m}

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{n}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} number of columns requested

\end{itemize}

\item[{Returns}] \leavevmode
a 2\sphinxhyphen{}dim array of shape \sphinxtitleref{(m, n)}

\end{description}\end{quote}

\end{fulllineitems}

\index{nprepeat\_row() (in module ipfp\_utils)@\spxentry{nprepeat\_row()}\spxextra{in module ipfp\_utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ipfp_utils:ipfp_utils.nprepeat_row}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{ipfp\_utils.}}\sphinxbfcode{\sphinxupquote{nprepeat\_row}}}{\emph{\DUrole{n}{v}\DUrole{p}{:} \DUrole{n}{numpy.array}}, \emph{\DUrole{n}{m}\DUrole{p}{:} \DUrole{n}{int}}}{{ $\rightarrow$ numpy.array}}
create a matrix with \sphinxtitleref{m} rows equal to \sphinxtitleref{v}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{v}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} a 1\sphinxhyphen{}dim array of size \sphinxtitleref{n}

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{m}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} number of rows requested

\end{itemize}

\item[{Returns}] \leavevmode
a 2\sphinxhyphen{}dim array of shape \sphinxtitleref{(m, n)}

\end{description}\end{quote}

\end{fulllineitems}

\index{print\_stars() (in module ipfp\_utils)@\spxentry{print\_stars()}\spxextra{in module ipfp\_utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{ipfp_utils:ipfp_utils.print_stars}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{ipfp\_utils.}}\sphinxbfcode{\sphinxupquote{print\_stars}}}{\emph{\DUrole{n}{title}\DUrole{p}{:} \DUrole{n}{str} \DUrole{o}{=} \DUrole{default_value}{None}}, \emph{\DUrole{n}{n}\DUrole{p}{:} \DUrole{n}{int} \DUrole{o}{=} \DUrole{default_value}{70}}}{{ $\rightarrow$ None}}
prints a starred line, or two around the title
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{title}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} title

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{n}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} number of stars on line

\end{itemize}

\item[{Returns}] \leavevmode
nothing

\end{description}\end{quote}

\end{fulllineitems}



\chapter{Module \sphinxstyleliteralintitle{\sphinxupquote{ipfp\_ex\_str}}}
\label{\detokenize{ipfp_ex_str:module-ipfp_ex_str}}\label{\detokenize{ipfp_ex_str:module-ipfp-ex-str}}\label{\detokenize{ipfp_ex_str::doc}}\index{module@\spxentry{module}!ipfp\_ex\_str@\spxentry{ipfp\_ex\_str}}\index{ipfp\_ex\_str@\spxentry{ipfp\_ex\_str}!module@\spxentry{module}}
Interactive Streamlit application that solves for equilibrium and estimates parameters     in a \sphinxhref{https://www.jstor.org/stable/10.1086/498585?seq=1}{Choo and Siow 2006} model         (homoskedastic model with singles)


\chapter{Module \sphinxstyleliteralintitle{\sphinxupquote{estimate\_cs\_fuvl}}}
\label{\detokenize{estimate_cs_fuvl:module-estimate_cs_fuvl}}\label{\detokenize{estimate_cs_fuvl:module-estimate-cs-fuvl}}\label{\detokenize{estimate_cs_fuvl::doc}}\index{module@\spxentry{module}!estimate\_cs\_fuvl@\spxentry{estimate\_cs\_fuvl}}\index{estimate\_cs\_fuvl@\spxentry{estimate\_cs\_fuvl}!module@\spxentry{module}}
Estimation of the \sphinxhref{https://www.jstor.org/stable/10.1086/498585?seq=1}{Choo and Siow 2006} model:
in its original version (homoskedastic with singles).

We minimize the \(F(u,v,\lambda)-\hat{\mu}\cdot \Phi^{\lambda}\) function of Galichon\textendash{}Salanie (2020, Proposition 5.)
\index{estimate\_cs\_fuvl() (in module estimate\_cs\_fuvl)@\spxentry{estimate\_cs\_fuvl()}\spxextra{in module estimate\_cs\_fuvl}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{estimate_cs_fuvl:estimate_cs_fuvl.estimate_cs_fuvl}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{estimate\_cs\_fuvl.}}\sphinxbfcode{\sphinxupquote{estimate\_cs\_fuvl}}}{\emph{\DUrole{n}{muxy}\DUrole{p}{:} \DUrole{n}{numpy.ndarray}}, \emph{\DUrole{n}{nx}\DUrole{p}{:} \DUrole{n}{numpy.ndarray}}, \emph{\DUrole{n}{my}\DUrole{p}{:} \DUrole{n}{numpy.ndarray}}, \emph{\DUrole{n}{bases}\DUrole{p}{:} \DUrole{n}{numpy.ndarray}}}{{ $\rightarrow$ scipy.optimize.optimize.OptimizeResult}}
this estimates the parameters and equilibrium utilities in a semilinear homoskedastic Choo\sphinxhyphen{}Siow model.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{muxy}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.ndarray}}) \textendash{} the numbers of matches in each \sphinxtitleref{(x,y)} cell, a \sphinxtitleref{(X,Y)} matrix

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{nx}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.ndarray}}) \textendash{} the numbers of men in each x cell, a \sphinxtitleref{X}\sphinxhyphen{}vector

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{my}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.ndarray}}) \textendash{} the numbers of women in each \sphinxtitleref{y} cell, a \sphinxtitleref{Y}\sphinxhyphen{}vector

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{bases}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.ndarray}}) \textendash{} the values of the K basis functions in each cell, a \sphinxtitleref{(X,Y,K)} array

\end{itemize}

\item[{Returns}] \leavevmode

a \sphinxtitleref{scipy.optimize.OptimizeResult} object \sphinxtitleref{resus}.     \sphinxtitleref{resus.x} has the estimates of \(u, v\),         and \(\lambda\) in that order:
\begin{itemize}
\item {} 
\(u_x\) the expected utility of men of type \sphinxtitleref{x}

\item {} 
\(v_y\) the expected utility of women of type \sphinxtitleref{y}

\item {} 
\(\lambda_k\) the coefficient of basis function \sphinxtitleref{k}

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}



\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{e}
\item\relax\sphinxstyleindexentry{estimate\_cs\_fuvl}\sphinxstyleindexpageref{estimate_cs_fuvl:\detokenize{module-estimate_cs_fuvl}}
\indexspace
\bigletter{i}
\item\relax\sphinxstyleindexentry{ipfp\_ex\_str}\sphinxstyleindexpageref{ipfp_ex_str:\detokenize{module-ipfp_ex_str}}
\item\relax\sphinxstyleindexentry{ipfp\_solvers}\sphinxstyleindexpageref{ipfp_solvers:\detokenize{module-ipfp_solvers}}
\item\relax\sphinxstyleindexentry{ipfp\_utils}\sphinxstyleindexpageref{ipfp_utils:\detokenize{module-ipfp_utils}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}